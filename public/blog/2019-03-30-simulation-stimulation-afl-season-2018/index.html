


<table>
<tbody>
<tr class="odd">
<td>title: ‘Simulation Stimulation: AFL Season 2018’</td>
</tr>
<tr class="even">
<td>author: Joshua White</td>
</tr>
<tr class="odd">
<td>date: ‘2019-03-30’</td>
</tr>
<tr class="even">
<td>slug: simulation-stimulation-afl-season-2018</td>
</tr>
<tr class="odd">
<td>categories:</td>
</tr>
<tr class="even">
<td>- R</td>
</tr>
<tr class="odd">
<td>tags:</td>
</tr>
<tr class="even">
<td>- AFL</td>
</tr>
<tr class="odd">
<td>- Sport</td>
</tr>
<tr class="even">
<td>- Simulations</td>
</tr>
<tr class="odd">
<td>image:</td>
</tr>
<tr class="even">
<td>caption: ’’</td>
</tr>
<tr class="odd">
<td>focal_point: ’’</td>
</tr>
<tr class="even">
<td>output:</td>
</tr>
<tr class="odd">
<td>html_document: default</td>
</tr>
</tbody>
</table>
<p>Recently I was, as I am (unfortunately) rather wont to do, aimlessly watching YouTube videos when I came across these <a href="https://www.youtube.com/watch?v=Vv9wpQIGZDw">two</a> <a href="https://www.youtube.com/watch?v=Zs2M7gWSbTg">videos</a> by Numberphile. Here, the authors discuss their attempts at modelling and simulating seasons of the English Premier League.</p>
<p>As an avid <a href="https://en.wikipedia.org/wiki/Australian_Football_League">AFL</a> fan, and with the upcoming season fast approaching (edit, now underway, <a href="https://www.urbandictionary.com/define.php?term=carn">carn</a> <a href="https://www.afl.com.au/news/2019-03-22/match-report-collingwood-v-geelong">the cats!</a>), why not try to apply these methods to the AFL season. This post will be the first of a three part series. In part 1, I will discuss the models and compare their results to the actual data from the 2018 season. Part 2 will apply the models to the 2019 season. And part 3 will go through the details and show the code.</p>
<p>## The Models</p>
<p>###Poisson Distributed Team Scores Okay, lets discuss the model. Basically, each team’s score in every game is modeled as a random drawing from a Poisson distribution — i.e. <span class="math inline">\(P(k) = e^{-\lambda} \frac{\lambda^k}{k!}\)</span>, where k is the number of points scored. A Poisson distribution is great for simple modelling because it only requires estimating one parameter, <span class="math inline">\(\lambda\)</span>. On the other hand, it isn’t exactly suited to the AFL context because the model assumes that all events (in this case, scoring a point) occur independently. In AFL, a goal in AFL is worth 6 points, violating this assumption.</p>
<p>In any case, let’s press on with that in mind. We calculate <span class="math inline">\(\lambda\)</span> for each game, based on the points scored for and against, at home and away, for each team in 2018:</p>
<p><span class="math inline">\(\lambda_{home team} =\)</span> League Average points scored at home <span class="math inline">\(\times\)</span> home team attack strength at home <span class="math inline">\(\times\)</span> awayteam attack strength away</p>
<p><span class="math inline">\(\lambda_{away team} =\)</span> League Average points scored away <span class="math inline">\(\times\)</span> away team attack strength away <span class="math inline">\(\times\)</span> hometeam defense strength at home</p>
<p>As you can see, the model takes into account the general home advantage as well as each particular team’s attack and defensive strengths at home and away. The strength parameters refereed to above are simply the averages for that particular team, relative to the league-wide average.</p>
<p>###Normally Distributed team scores This model is a simple extension to the Poisson-based model above, and should be superior to it because:</p>
<ol style="list-style-type: decimal">
<li>There is no assumption of independence, and</li>
<li>It has an extra parameter to capture differences among teams in the variance of their defense and attack strength.</li>
</ol>
<p>Here, it is assumed that team scores are normally distributed around <span class="math inline">\(\lambda\)</span> as defined above, with a standard deviation calculated as the pooled standard deviation of that teams ‘for’ scores standard deviation, and the opponents ‘against’ scores standard deviation: <span class="math display">\[Points_{teamA} \sim \mathcal{N}(\mu=\lambda,\,\sigma = \sigma_p)\,\]</span> where: <br> <span class="math display">\[\sigma_{p}=\frac{\sigma_{teamAfor} + \sigma_{teamBagainst}}{2}\]</span></p>
<p>###Rankings model: tanh This model simply relies on the ordinal data of last years final Ladder: Carlton, the wooden spoon winners (i.e. the last placeholders, out of 18 teams) get a ranking of 1, and Richmond, who finished on top of the table get a ranking of 18. Then, with this information, the probability of team A winning is modelled as follows:</p>
<p><span class="math display">\[P(A\&gt;wins)=\frac{tanh(\frac{a-b}{w} + d)+1}{2}\]</span> where,<br> A = home team <br> a = home team ranking <br> b = away team ranking <br> w = weighting parameter (the higher the number the less weight placed on the rankings) <br> d = draw paramater, to allow for possibility of draws, calculated as so that <span class="math inline">\(tanh(d) = -draw\&gt;rate\)</span></p>
<p>The draw rate, <span class="math inline">\(\frac{7}{990} \approx 0.007\)</span>, was based on the likelihood of drawing a game over the past 5 years.</p>
<p>The probability of B winning is calculated in the same manner as above, except with <span class="math inline">\(b-a\)</span>.</p>
<p>Finally, a draw is the remaining probability: <span class="math inline">\(P(Draw)= 1 - P(A\&gt;wins) - P(B\&gt;wins)\)</span>. This means that the draw rate will be greater for greater rankings differentials, and greater for greater weight parameters.</p>
<p>## The Data</p>
<p><code>r   pointstidy</code></p>
<p><code>## # A tibble: 792 x 4   ##    HorA  Team                   FororAgainst Points   ##    &lt;chr&gt; &lt;chr&gt;                  &lt;chr&gt;         &lt;dbl&gt;   ##  1 H     Richmond               For             121   ##  2 H     Essendon               For              99   ##  3 H     St Kilda               For             107   ##  4 H     Port Adelaide          For             110   ##  5 H     Gold Coast             For              55   ##  6 H     Hawthorn               For             101   ##  7 H     Greater Western Sydney For             133   ##  8 H     Melbourne              For              94   ##  9 H     West Coast             For              86   ## 10 H     Adelaide               For             118   ## # ... with 782 more rows</code></p>
<p><code>r   fixture2019</code></p>
<p><code>## # A tibble: 198 x 2   ##    Hometeam               Awayteam          ##    &lt;chr&gt;                  &lt;chr&gt;             ##  1 Carlton                Richmond          ##  2 Collingwood            Geelong           ##  3 Melbourne              Port Adelaide     ##  4 Adelaide               Hawthorn          ##  5 Brisbane Lions         West Coast        ##  6 Western Bulldogs       Sydney            ##  7 St Kilda               Gold Coast        ##  8 Greater Western Sydney Essendon          ##  9 Fremantle              North Melbourne   ## 10 Richmond               Collingwood       ## # ... with 188 more rows</code></p>
<p>##Results</p>
<p>###Poisson model</p>
<p><code>r   Finalsimtablepois.2018</code></p>
<p><code>##                      Team MedianPos MeanPos BestPos WorstPos percentWon   ## 1                Richmond       1.0     1.6       1        4         60   ## 2               Melbourne       2.0     1.9       1        3         30   ## 3             Collingwood       3.0     3.5       1        5         10   ## 4                 Geelong       4.0     4.7       2        8          0   ## 5                Hawthorn       5.5     5.2       3        8          0   ## 6              West Coast       5.5     5.5       2        8          0   ## 7  Greater Western Sydney       7.0     7.4       5       11          0   ## 8           Port Adelaide       8.0     7.8       5       11          0   ## 9         North Melbourne       9.0     8.1       5       11          0   ## 10               Adelaide      10.0    10.5       9       12          0   ## 11               Essendon      11.0    10.9       9       12          0   ## 12                 Sydney      11.0    11.3       9       14          0   ## 13              Fremantle      13.0    13.4      13       14          0   ## 14         Brisbane Lions      13.5    13.4      12       15          0   ## 15       Western Bulldogs      15.0    15.4      15       16          0   ## 16               St Kilda      16.0    15.5      14       17          0   ## 17             Gold Coast      17.0    17.2      16       18          0   ## 18                Carlton      18.0    17.7      17       18          0   ##    percentTop4 percentTop8 percentBottom4 percentLast   ## 1          100         100              0           0   ## 2          100         100              0           0   ## 3           70         100              0           0   ## 4           60         100              0           0   ## 5           40         100              0           0   ## 6           30         100              0           0   ## 7            0          80              0           0   ## 8            0          80              0           0   ## 9            0          40              0           0   ## 10           0           0              0           0   ## 11           0           0              0           0   ## 12           0           0              0           0   ## 13           0           0              0           0   ## 14           0           0             20           0   ## 15           0           0            100           0   ## 16           0           0             80           0   ## 17           0           0            100          30   ## 18           0           0            100          70</code></p>
<p>###Normal model</p>
<p><code>r   Finalsimtablenorm.2018</code></p>
<p><code>##                      Team MedianPos MeanPos BestPos WorstPos percentWon   ## 1                Richmond       1.0     1.6       1        4         60   ## 2               Melbourne       2.0     1.9       1        3         30   ## 3             Collingwood       3.0     3.5       1        5         10   ## 4                 Geelong       4.0     4.7       2        8          0   ## 5                Hawthorn       5.5     5.2       3        8          0   ## 6              West Coast       5.5     5.5       2        8          0   ## 7  Greater Western Sydney       7.0     7.4       5       11          0   ## 8           Port Adelaide       8.0     7.8       5       11          0   ## 9         North Melbourne       9.0     8.1       5       11          0   ## 10               Adelaide      10.0    10.5       9       12          0   ## 11               Essendon      11.0    10.9       9       12          0   ## 12                 Sydney      11.0    11.3       9       14          0   ## 13              Fremantle      13.0    13.4      13       14          0   ## 14         Brisbane Lions      13.5    13.4      12       15          0   ## 15       Western Bulldogs      15.0    15.4      15       16          0   ## 16               St Kilda      16.0    15.5      14       17          0   ## 17             Gold Coast      17.0    17.2      16       18          0   ## 18                Carlton      18.0    17.7      17       18          0   ##    percentTop4 percentTop8 percentBottom4 percentLast   ## 1          100         100              0           0   ## 2          100         100              0           0   ## 3           70         100              0           0   ## 4           60         100              0           0   ## 5           40         100              0           0   ## 6           30         100              0           0   ## 7            0          80              0           0   ## 8            0          80              0           0   ## 9            0          40              0           0   ## 10           0           0              0           0   ## 11           0           0              0           0   ## 12           0           0              0           0   ## 13           0           0              0           0   ## 14           0           0             20           0   ## 15           0           0            100           0   ## 16           0           0             80           0   ## 17           0           0            100          30   ## 18           0           0            100          70</code></p>
<p>###Tanh model</p>
<p><code>r   Finalsimlist.2018[[1]] %&gt;% tibble()</code></p>
<p><code>## # A tibble: 18 x 1   ##    .$Team $MedianPos $MeanPos $BestPos $WorstPos $percentWon $percentTop4   ##    &lt;fct&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;   ##  1 Richm~        1        1.3        1         2          70          100   ##  2 West ~        2        1.7        1         2          30          100   ##  3 Hawth~        3        3.2        3         4           0          100   ##  4 Colli~        4        3.8        3         4           0          100   ##  5 Melbo~        5        5          5         5           0            0   ##  6 Sydney        6        6.4        6         8           0            0   ##  7 Great~        7        6.7        6         7           0            0   ##  8 North~        8        7.9        7         8           0            0   ##  9 Port ~        9        9          9         9           0            0   ## 10 Geelo~       10       10         10        10           0            0   ## 11 Essen~       11       11.1       11        12           0            0   ## 12 Adela~       12       12.3       11        14           0            0   ## 13 Weste~       13       13.3       13        14           0            0   ## 14 Frema~       13.5     13.4       12        15           0            0   ## 15 Brisb~       15       14.9       14        15           0            0   ## 16 St Ki~       16       16.7       16        18           0            0   ## 17 Gold ~       17       16.8       16        18           0            0   ## 18 Carlt~       17.5     17.5       17        18           0            0   ## # ... with 3 more variables: $percentTop8 &lt;dbl&gt;, $percentBottom4 &lt;dbl&gt;,   ## #   $percentLast &lt;dbl&gt;</code></p>
<p><code>r   Finalsimlist.2018[[20]] %&gt;% tibble()</code></p>
<p><code>## # A tibble: 18 x 1   ##    .$Team $MedianPos $MeanPos $BestPos $WorstPos $percentWon $percentTop4   ##    &lt;fct&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;   ##  1 Richm~        3        2.7        1         5          30           90   ##  2 Colli~        3.5      3.4        1         7          10           80   ##  3 West ~        3.5      4.1        1        10          20           60   ##  4 Hawth~        4.5      4.6        1        10          30           50   ##  5 Great~        5.5      6.4        2        10           0           30   ##  6 Melbo~        6.5      6          1        11          10           30   ##  7 North~        7        6.6        2        10           0           10   ##  8 Weste~        8        8.7        5        13           0            0   ##  9 Sydney        9.5      9.3        3        14           0           10   ## 10 Adela~       11       10.9        2        18           0           10   ## 11 Frema~       12       11.6        8        16           0            0   ## 12 Port ~       12       12          6        17           0            0   ## 13 Essen~       12.5     11.8        3        18           0           20   ## 14 Brisb~       14       14.4       11        18           0            0   ## 15 Geelo~       14.5     12.5        4        17           0           10   ## 16 St Ki~       15       14.5       10        18           0            0   ## 17 Gold ~       16       15.8       11        18           0            0   ## 18 Carlt~       17       15.7        6        18           0            0   ## # ... with 3 more variables: $percentTop8 &lt;dbl&gt;, $percentBottom4 &lt;dbl&gt;,   ## #   $percentLast &lt;dbl&gt;</code></p>
<p><code>r   Finalsimlist.2018[[50]] %&gt;% tibble()</code></p>
<p><code>## # A tibble: 18 x 1   ##    .$Team $MedianPos $MeanPos $BestPos $WorstPos $percentWon $percentTop4   ##    &lt;fct&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;   ##  1 West ~        3.5      6          1        18          30           60   ##  2 Richm~        4        6          1        16          10           50   ##  3 Sydney        5        7.7        3        18           0           40   ##  4 Colli~        5.5      6.1        1        14          20           40   ##  5 Hawth~        7        7.2        1        15          10           40   ##  6 Melbo~        8        6.9        1        13          10           40   ##  7 Great~        8.5      9.3        3        15           0           10   ##  8 Port ~        9        8.2        2        15           0           40   ##  9 North~        9        9          3        16           0           10   ## 10 Geelo~        9        9.3        3        15           0           10   ## 11 Frema~       10       10.4        6        16           0            0   ## 12 Adela~       11.5     11          4        17           0           10   ## 13 Essen~       12       11.4        1        18          10           10   ## 14 Weste~       12.5     11.2        1        18          10           20   ## 15 Carlt~       12.5     12.4        2        18           0           10   ## 16 Brisb~       13       12.2        6        18           0            0   ## 17 Gold ~       13       13.7       10        18           0            0   ## 18 St Ki~       14       13          4        17           0           10   ## # ... with 3 more variables: $percentTop8 &lt;dbl&gt;, $percentBottom4 &lt;dbl&gt;,   ## #   $percentLast &lt;dbl&gt;</code></p>
<p><code>r   Finalsimlist.2018[[100]] %&gt;% tibble()</code></p>
<p><code>## # A tibble: 18 x 1   ##    .$Team $MedianPos $MeanPos $BestPos $WorstPos $percentWon $percentTop4   ##    &lt;fct&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;   ##  1 Geelo~        4        5.9        1        13          20           50   ##  2 Richm~        5        7.3        1        18          20           50   ##  3 Hawth~        6        5.8        1        12          20           40   ##  4 St Ki~        6.5      8          1        18          10           40   ##  5 Colli~        6.5      8.1        2        16           0           40   ##  6 Melbo~        7.5      9.4        2        18           0           30   ##  7 Weste~        8        7.3        1        15          20           30   ##  8 Great~        8        8.1        2        15           0           10   ##  9 West ~        9        9.3        2        17           0           20   ## 10 Sydney        9.5     10          3        18           0           20   ## 11 Port ~        9.5     10.4        4        17           0           10   ## 12 Gold ~       10       10.8        4        17           0           10   ## 13 Adela~       11.5     10.4        5        16           0            0   ## 14 Frema~       12       10.3        2        16           0           10   ## 15 Carlt~       12       11.2        3        18           0           20   ## 16 North~       12.5     12.7        7        18           0            0   ## 17 Essen~       13.5     12.7        4        18           0           10   ## 18 Brisb~       15       13.3        1        18          10           10   ## # ... with 3 more variables: $percentTop8 &lt;dbl&gt;, $percentBottom4 &lt;dbl&gt;,   ## #   $percentLast &lt;dbl&gt;</code></p>
<p><code>r   Finalsimlist.2018[[500]] %&gt;% tibble()</code></p>
<p><code>## # A tibble: 18 x 1   ##    .$Team $MedianPos $MeanPos $BestPos $WorstPos $percentWon $percentTop4   ##    &lt;fct&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;   ##  1 Carlt~        7        8.6        1        17          10           30   ##  2 Port ~        7.5      7.9        1        17          10           20   ##  3 Hawth~        7.5      8          1        16          10           30   ##  4 Frema~        8        7.7        1        16          10           30   ##  5 Geelo~        8        8.5        2        18           0           40   ##  6 Richm~        8        8.7        1        18          10           30   ##  7 St Ki~        8.5      7.9        1        14          10           20   ##  8 West ~        8.5      9.2        1        17          10           30   ##  9 Great~        9        8.9        1        17          10           20   ## 10 Weste~        9        9.4        4        18           0           20   ## 11 Sydney        9.5     10          2        18           0           10   ## 12 Adela~        9.5     10.5        1        18          10           20   ## 13 North~       11        9.8        4        16           0           20   ## 14 Gold ~       11       10.9        6        15           0            0   ## 15 Melbo~       12        9.8        2        17           0           30   ## 16 Essen~       12       12          1        18          10           10   ## 17 Brisb~       13       11.2        2        18           0           30   ## 18 Colli~       13       12          2        16           0           10   ## # ... with 3 more variables: $percentTop8 &lt;dbl&gt;, $percentBottom4 &lt;dbl&gt;,   ## #   $percentLast &lt;dbl&gt;</code></p>
<p><code>r   Finalsimlist.2018[[1000]] %&gt;% tibble()</code></p>
<p><code>## # A tibble: 18 x 1   ##    .$Team $MedianPos $MeanPos $BestPos $WorstPos $percentWon $percentTop4   ##    &lt;fct&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;   ##  1 Great~        5        7.5        2        18           0           50   ##  2 Adela~        5.5      6.1        1        16          20           40   ##  3 Port ~        5.5      7.6        2        18           0           50   ##  4 Geelo~        7        7.7        1        16          10           40   ##  5 St Ki~        7        8.2        2        16           0           40   ##  6 West ~        7.5      8.3        1        17          10           30   ##  7 Richm~        8.5      9.7        3        17           0           10   ##  8 Frema~        8.5     10          1        18          10           10   ##  9 Hawth~        9        8.8        3        14           0           10   ## 10 Melbo~        9.5      9.5        1        18          10           30   ## 11 Carlt~       10        9.4        1        18          20           30   ## 12 Weste~       11       11.4        8        17           0            0   ## 13 Sydney       11.5     10.4        2        18           0           10   ## 14 Brisb~       12       10.7        5        15           0            0   ## 15 Essen~       12       10.9        4        17           0           10   ## 16 North~       12       12.9        7        18           0            0   ## 17 Colli~       13       11.5        2        18           0           10   ## 18 Gold ~       13.5     10.4        1        17          20           30   ## # ... with 3 more variables: $percentTop8 &lt;dbl&gt;, $percentBottom4 &lt;dbl&gt;,   ## #   $percentLast &lt;dbl&gt;</code></p>
<p>OKay, so we don’t have to keep doing simulations with all these different weight parameters, let’s see which ones do the best job of simulating the data. We are going to have to pay it by ear a little based on intuition, however, because we have used the same data to test the model, and we want to avoid overfitting. So we will pick the best model based on (1) it’s spearman coefficient with last year’s ladder and (2) its ability to have varation (the same team doesn’t simply win each year)</p>
<p>```r ##Create order comparisons table## #should change this to use lapply or try to put loop insid dataframe fucntion<br />
for (w in c(1, 20, 50, 100, 500, 1000)){ name &lt;- paste0(“Ordertanh.”, w) assign(name, match(finalTable2018<span class="math inline">\(Team, Finalsimlist.2018[[w]]\)</span>Team))</p>
<p>}</p>
<p>ordercomparison.2018.tanh &lt;- data.frame(Team = factor(finalTable2018$Team), Order2018 = 1:18, Ordertanh.1, Ordertanh.20, Ordertanh.50, Ordertanh.100, Ordertanh.500, Ordertanh.1000) ordercomparison.2018.tanh ```</p>
<p><code>##                      Team Order2018 Ordertanh.1 Ordertanh.20 Ordertanh.50   ## 1                Richmond         1           1            1            2   ## 2              West Coast         2           2            3            1   ## 3             Collingwood         3           4            2            4   ## 4                Hawthorn         4           3            4            5   ## 5               Melbourne         5           5            6            6   ## 6                  Sydney         6           6            9            3   ## 7  Greater Western Sydney         7           7            5            7   ## 8                 Geelong         8          10           15           10   ## 9         North Melbourne         9           8            7            9   ## 10          Port Adelaide        10           9           12            8   ## 11               Essendon        11          11           13           13   ## 12               Adelaide        12          12           10           12   ## 13       Western Bulldogs        13          13            8           14   ## 14              Fremantle        14          14           11           11   ## 15         Brisbane Lions        15          15           14           16   ## 16               St Kilda        16          16           16           18   ## 17             Gold Coast        17          17           17           17   ## 18                Carlton        18          18           18           15   ##    Ordertanh.100 Ordertanh.500 Ordertanh.1000   ## 1              2             6              7   ## 2              9             8              6   ## 3              5            18             17   ## 4              3             3              9   ## 5              6            15             10   ## 6             10            11             13   ## 7              8             9              1   ## 8              1             5              4   ## 9             16            13             16   ## 10            11             2              3   ## 11            17            16             15   ## 12            13            12              2   ## 13             7            10             12   ## 14            14             4              8   ## 15            18            17             14   ## 16             4             7              5   ## 17            12            14             18   ## 18            15             1             11</code></p>
<p>```r cormatrix.weights &lt;- cor(ordercomparison.2018.tanh[,2:ncol(ordercomparison.2018.tanh)], use = “all.obs”, method = “spearman”)</p>
<p># lets find a nice way to graphically look at that ggcorrplot(cormatrix.weights, lab = TRUE, show.legend = TRUE) ```</p>
<p><img src="/blog/2019-03-30-simulation-stimulation-afl-season-2018_files/figure-html/tanhcomparisons-1.png" width="672" /></p>
<p>So on this basis, we will choose a weight parameter value of 20 as, on inspection of simulation results, it allows for enough randomness in the system to allow teams in the top 8 some likelihood of winning the cup, but denies the chance for the really teams for winning. Let’s be honest, carlton’s chance of winning the premiership is less than 1 in a million.</p>
<p>##Comparing the three models.</p>
<p>```r #create table with different orders. ordercomparison.2018 &lt;- data.frame(Team = factor(finalTable2018<span class="math inline">\(Team),  Order2018 = 1:18,  OrderNorm.2018 = match(finalTable2018\)</span>Team, Finalsimtablenorm.2018<span class="math inline">\(Team),  OrderPois.2018 = match(finalTable2018\)</span>Team, Finalsimtablepois.2018<span class="math inline">\(Team),  OrderTanh.2018 = match(finalTable2018\)</span>Team, Finalsimlist.2018[[20]]$Team))</p>
<p>ordercomparison.2018 %&gt;% tibble() ```</p>
<p><code>## # A tibble: 18 x 1   ##    .$Team        $Order2018 $OrderNorm.2018 $OrderPois.2018 $OrderTanh.2018   ##    &lt;fct&gt;              &lt;int&gt;           &lt;int&gt;           &lt;int&gt;           &lt;int&gt;   ##  1 Richmond               1               1               1               1   ##  2 West Coast             2               6               6               3   ##  3 Collingwood            3               3               3               2   ##  4 Hawthorn               4               5               5               4   ##  5 Melbourne              5               2               2               6   ##  6 Sydney                 6              12              12               9   ##  7 Greater West~          7               7               7               5   ##  8 Geelong                8               4               4              15   ##  9 North Melbou~          9               9               9               7   ## 10 Port Adelaide         10               8               8              12   ## 11 Essendon              11              11              11              13   ## 12 Adelaide              12              10              10              10   ## 13 Western Bull~         13              15              15               8   ## 14 Fremantle             14              13              13              11   ## 15 Brisbane Lio~         15              14              14              14   ## 16 St Kilda              16              16              16              16   ## 17 Gold Coast            17              17              17              17   ## 18 Carlton               18              18              18              18</code></p>
<p><code>r   #Let's now get the spearman's correlation coefficients and show that in a correlatin matrix   cormatrix.2018 &lt;- cor(ordercomparison.2018[,2:5], use = &quot;all.obs&quot;, method = &quot;spearman&quot;)   ggcorrplot(cormatrix.2018, lab = TRUE)</code></p>
<p><img src="/blog/2019-03-30-simulation-stimulation-afl-season-2018_files/figure-html/comparing%20the%20models-1.png" width="672" /></p>
<p>```r #graphing and comparing the two models.</p>
<p>#create mode function Mode &lt;- function(x) { ux &lt;- unique(x) ux[which.max(tabulate(match(x, ux)))] } ###GRAPH FOR POISSON MODEL###</p>
<p>#transpose data to tidy form for use in ggplot SimResultspois.2018$simNumber &lt;- sprintf(“sim%d”, seq(1:Nsim.pois.2018)) SimResultspois.2018.tidy &lt;- gather(SimResultspois.2018,“Team”, “Position”, -simNumber)</p>
<p>#create ordered factor to order graph SimResultspois.2018.tidy<span class="math inline">\(Team &lt;- factor(SimResultspois.2018.tidy\)</span>Team, levels = Finalsimtablepois.2018$Team)</p>
<p>#create graph ggplot(SimResultspois.2018.tidy, aes(x = Team, y = Position)) + geom_violin(aes(fill = Team, col = Team), trim = TRUE, kernel = “gaussian”, adjust = 3) + stat_summary(fun.y=median, geom=“point”, size=4, color=“black”, shape = 0) + stat_summary(fun.y=mean, geom=“point”, size=3, color=“black”, shape = 2) + stat_summary(fun.y=Mode, geom=“point”, size=1, color=“black”, shape = 19) + coord_flip(ylim = c(1,18)) + scale_y_continuous(breaks = 1:18, labels = 1:18) + theme(legend.position = “none”, panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank()) ```</p>
<p><img src="/blog/2019-03-30-simulation-stimulation-afl-season-2018_files/figure-html/graphs-1.png" width="672" /></p>
<p>```r ###GRAPH FOR NORM MODEL###</p>
<p>#transpose data to tidy form for use in ggplot SimResultsnorm.2018$simNumber &lt;- sprintf(“sim%d”, seq(1:Nsim.norm.2018)) SimResultsnorm.2018.tidy &lt;- gather(SimResultsnorm.2018,“Team”, “Position”, -simNumber)</p>
<p>#create ordered factor to order graph SimResultsnorm.2018.tidy<span class="math inline">\(Team &lt;- factor(SimResultsnorm.2018.tidy\)</span>Team, levels = Finalsimtablenorm.2018$Team)</p>
<p>#create graph ggplot(SimResultsnorm.2018.tidy, aes(x = Team, y = Position)) + geom_violin(aes(fill = Team, col = Team), trim = TRUE, kernel = “gaussian”, adjust = 3) + stat_summary(fun.y=median, geom=“point”, size=4, color=“black”, shape = 0) + stat_summary(fun.y=mean, geom=“point”, size=3, color=“black”, shape = 2) + stat_summary(fun.y=Mode, geom=“point”, size=1, color=“black”, shape = 19) + coord_flip(ylim = c(1,18)) + scale_y_continuous(breaks = 1:18, labels = 1:18) + theme(legend.position = “none”, panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank()) ```</p>
<p><img src="/blog/2019-03-30-simulation-stimulation-afl-season-2018_files/figure-html/graphs-2.png" width="672" /></p>
<p>```r ## create comparison graphs ##</p>
<p>#combine two graphs## Finalsimtablenorm.2018<span class="math inline">\(Model &lt;- &quot;norm&quot;  Finalsimtablepois.2018\)</span>Model &lt;- “pois” Finalsimlist.2018[[20]]$Model &lt;- “tanh”</p>
<p>comparisonSimTable.2018 &lt;- rbind(Finalsimtablenorm.2018, Finalsimtablepois.2018, Finalsimlist.2018[[20]]) comparisonSimTable.2018<span class="math inline">\(Model &lt;- factor(comparisonSimTable.2018\)</span>Model)</p>
<p># create tidy data to compare a lot in one go comparisonSimTable.2018.tidy &lt;- gather(comparisonSimTable.2018, “Type”, “Percent”, 6:10) comparisonSimTable.2018.tidy ```</p>
<p><code>##                       Team MedianPos MeanPos BestPos WorstPos Model   ## 1                 Richmond       1.0     1.6       1        4  norm   ## 2                Melbourne       2.0     1.9       1        3  norm   ## 3              Collingwood       3.0     3.5       1        5  norm   ## 4                  Geelong       4.0     4.7       2        8  norm   ## 5                 Hawthorn       5.5     5.2       3        8  norm   ## 6               West Coast       5.5     5.5       2        8  norm   ## 7   Greater Western Sydney       7.0     7.4       5       11  norm   ## 8            Port Adelaide       8.0     7.8       5       11  norm   ## 9          North Melbourne       9.0     8.1       5       11  norm   ## 10                Adelaide      10.0    10.5       9       12  norm   ## 11                Essendon      11.0    10.9       9       12  norm   ## 12                  Sydney      11.0    11.3       9       14  norm   ## 13               Fremantle      13.0    13.4      13       14  norm   ## 14          Brisbane Lions      13.5    13.4      12       15  norm   ## 15        Western Bulldogs      15.0    15.4      15       16  norm   ## 16                St Kilda      16.0    15.5      14       17  norm   ## 17              Gold Coast      17.0    17.2      16       18  norm   ## 18                 Carlton      18.0    17.7      17       18  norm   ## 19                Richmond       1.0     1.6       1        4  pois   ## 20               Melbourne       2.0     1.9       1        3  pois   ## 21             Collingwood       3.0     3.5       1        5  pois   ## 22                 Geelong       4.0     4.7       2        8  pois   ## 23                Hawthorn       5.5     5.2       3        8  pois   ## 24              West Coast       5.5     5.5       2        8  pois   ## 25  Greater Western Sydney       7.0     7.4       5       11  pois   ## 26           Port Adelaide       8.0     7.8       5       11  pois   ## 27         North Melbourne       9.0     8.1       5       11  pois   ## 28                Adelaide      10.0    10.5       9       12  pois   ## 29                Essendon      11.0    10.9       9       12  pois   ## 30                  Sydney      11.0    11.3       9       14  pois   ## 31               Fremantle      13.0    13.4      13       14  pois   ## 32          Brisbane Lions      13.5    13.4      12       15  pois   ## 33        Western Bulldogs      15.0    15.4      15       16  pois   ## 34                St Kilda      16.0    15.5      14       17  pois   ## 35              Gold Coast      17.0    17.2      16       18  pois   ## 36                 Carlton      18.0    17.7      17       18  pois   ## 37                Richmond       3.0     2.7       1        5  tanh   ## 38             Collingwood       3.5     3.4       1        7  tanh   ## 39              West Coast       3.5     4.1       1       10  tanh   ## 40                Hawthorn       4.5     4.6       1       10  tanh   ## 41  Greater Western Sydney       5.5     6.4       2       10  tanh   ## 42               Melbourne       6.5     6.0       1       11  tanh   ## 43         North Melbourne       7.0     6.6       2       10  tanh   ## 44        Western Bulldogs       8.0     8.7       5       13  tanh   ## 45                  Sydney       9.5     9.3       3       14  tanh   ## 46                Adelaide      11.0    10.9       2       18  tanh   ## 47               Fremantle      12.0    11.6       8       16  tanh   ## 48           Port Adelaide      12.0    12.0       6       17  tanh   ## 49                Essendon      12.5    11.8       3       18  tanh   ## 50          Brisbane Lions      14.0    14.4      11       18  tanh   ## 51                 Geelong      14.5    12.5       4       17  tanh   ## 52                St Kilda      15.0    14.5      10       18  tanh   ## 53              Gold Coast      16.0    15.8      11       18  tanh   ## 54                 Carlton      17.0    15.7       6       18  tanh   ## 55                Richmond       1.0     1.6       1        4  norm   ## 56               Melbourne       2.0     1.9       1        3  norm   ## 57             Collingwood       3.0     3.5       1        5  norm   ## 58                 Geelong       4.0     4.7       2        8  norm   ## 59                Hawthorn       5.5     5.2       3        8  norm   ## 60              West Coast       5.5     5.5       2        8  norm   ## 61  Greater Western Sydney       7.0     7.4       5       11  norm   ## 62           Port Adelaide       8.0     7.8       5       11  norm   ## 63         North Melbourne       9.0     8.1       5       11  norm   ## 64                Adelaide      10.0    10.5       9       12  norm   ## 65                Essendon      11.0    10.9       9       12  norm   ## 66                  Sydney      11.0    11.3       9       14  norm   ## 67               Fremantle      13.0    13.4      13       14  norm   ## 68          Brisbane Lions      13.5    13.4      12       15  norm   ## 69        Western Bulldogs      15.0    15.4      15       16  norm   ## 70                St Kilda      16.0    15.5      14       17  norm   ## 71              Gold Coast      17.0    17.2      16       18  norm   ## 72                 Carlton      18.0    17.7      17       18  norm   ## 73                Richmond       1.0     1.6       1        4  pois   ## 74               Melbourne       2.0     1.9       1        3  pois   ## 75             Collingwood       3.0     3.5       1        5  pois   ## 76                 Geelong       4.0     4.7       2        8  pois   ## 77                Hawthorn       5.5     5.2       3        8  pois   ## 78              West Coast       5.5     5.5       2        8  pois   ## 79  Greater Western Sydney       7.0     7.4       5       11  pois   ## 80           Port Adelaide       8.0     7.8       5       11  pois   ## 81         North Melbourne       9.0     8.1       5       11  pois   ## 82                Adelaide      10.0    10.5       9       12  pois   ## 83                Essendon      11.0    10.9       9       12  pois   ## 84                  Sydney      11.0    11.3       9       14  pois   ## 85               Fremantle      13.0    13.4      13       14  pois   ## 86          Brisbane Lions      13.5    13.4      12       15  pois   ## 87        Western Bulldogs      15.0    15.4      15       16  pois   ## 88                St Kilda      16.0    15.5      14       17  pois   ## 89              Gold Coast      17.0    17.2      16       18  pois   ## 90                 Carlton      18.0    17.7      17       18  pois   ## 91                Richmond       3.0     2.7       1        5  tanh   ## 92             Collingwood       3.5     3.4       1        7  tanh   ## 93              West Coast       3.5     4.1       1       10  tanh   ## 94                Hawthorn       4.5     4.6       1       10  tanh   ## 95  Greater Western Sydney       5.5     6.4       2       10  tanh   ## 96               Melbourne       6.5     6.0       1       11  tanh   ## 97         North Melbourne       7.0     6.6       2       10  tanh   ## 98        Western Bulldogs       8.0     8.7       5       13  tanh   ## 99                  Sydney       9.5     9.3       3       14  tanh   ## 100               Adelaide      11.0    10.9       2       18  tanh   ## 101              Fremantle      12.0    11.6       8       16  tanh   ## 102          Port Adelaide      12.0    12.0       6       17  tanh   ## 103               Essendon      12.5    11.8       3       18  tanh   ## 104         Brisbane Lions      14.0    14.4      11       18  tanh   ## 105                Geelong      14.5    12.5       4       17  tanh   ## 106               St Kilda      15.0    14.5      10       18  tanh   ## 107             Gold Coast      16.0    15.8      11       18  tanh   ## 108                Carlton      17.0    15.7       6       18  tanh   ## 109               Richmond       1.0     1.6       1        4  norm   ## 110              Melbourne       2.0     1.9       1        3  norm   ## 111            Collingwood       3.0     3.5       1        5  norm   ## 112                Geelong       4.0     4.7       2        8  norm   ## 113               Hawthorn       5.5     5.2       3        8  norm   ## 114             West Coast       5.5     5.5       2        8  norm   ## 115 Greater Western Sydney       7.0     7.4       5       11  norm   ## 116          Port Adelaide       8.0     7.8       5       11  norm   ## 117        North Melbourne       9.0     8.1       5       11  norm   ## 118               Adelaide      10.0    10.5       9       12  norm   ## 119               Essendon      11.0    10.9       9       12  norm   ## 120                 Sydney      11.0    11.3       9       14  norm   ## 121              Fremantle      13.0    13.4      13       14  norm   ## 122         Brisbane Lions      13.5    13.4      12       15  norm   ## 123       Western Bulldogs      15.0    15.4      15       16  norm   ## 124               St Kilda      16.0    15.5      14       17  norm   ## 125             Gold Coast      17.0    17.2      16       18  norm   ## 126                Carlton      18.0    17.7      17       18  norm   ## 127               Richmond       1.0     1.6       1        4  pois   ## 128              Melbourne       2.0     1.9       1        3  pois   ## 129            Collingwood       3.0     3.5       1        5  pois   ## 130                Geelong       4.0     4.7       2        8  pois   ## 131               Hawthorn       5.5     5.2       3        8  pois   ## 132             West Coast       5.5     5.5       2        8  pois   ## 133 Greater Western Sydney       7.0     7.4       5       11  pois   ## 134          Port Adelaide       8.0     7.8       5       11  pois   ## 135        North Melbourne       9.0     8.1       5       11  pois   ## 136               Adelaide      10.0    10.5       9       12  pois   ## 137               Essendon      11.0    10.9       9       12  pois   ## 138                 Sydney      11.0    11.3       9       14  pois   ## 139              Fremantle      13.0    13.4      13       14  pois   ## 140         Brisbane Lions      13.5    13.4      12       15  pois   ## 141       Western Bulldogs      15.0    15.4      15       16  pois   ## 142               St Kilda      16.0    15.5      14       17  pois   ## 143             Gold Coast      17.0    17.2      16       18  pois   ## 144                Carlton      18.0    17.7      17       18  pois   ## 145               Richmond       3.0     2.7       1        5  tanh   ## 146            Collingwood       3.5     3.4       1        7  tanh   ## 147             West Coast       3.5     4.1       1       10  tanh   ## 148               Hawthorn       4.5     4.6       1       10  tanh   ## 149 Greater Western Sydney       5.5     6.4       2       10  tanh   ## 150              Melbourne       6.5     6.0       1       11  tanh   ## 151        North Melbourne       7.0     6.6       2       10  tanh   ## 152       Western Bulldogs       8.0     8.7       5       13  tanh   ## 153                 Sydney       9.5     9.3       3       14  tanh   ## 154               Adelaide      11.0    10.9       2       18  tanh   ## 155              Fremantle      12.0    11.6       8       16  tanh   ## 156          Port Adelaide      12.0    12.0       6       17  tanh   ## 157               Essendon      12.5    11.8       3       18  tanh   ## 158         Brisbane Lions      14.0    14.4      11       18  tanh   ## 159                Geelong      14.5    12.5       4       17  tanh   ## 160               St Kilda      15.0    14.5      10       18  tanh   ## 161             Gold Coast      16.0    15.8      11       18  tanh   ## 162                Carlton      17.0    15.7       6       18  tanh   ## 163               Richmond       1.0     1.6       1        4  norm   ## 164              Melbourne       2.0     1.9       1        3  norm   ## 165            Collingwood       3.0     3.5       1        5  norm   ## 166                Geelong       4.0     4.7       2        8  norm   ## 167               Hawthorn       5.5     5.2       3        8  norm   ## 168             West Coast       5.5     5.5       2        8  norm   ## 169 Greater Western Sydney       7.0     7.4       5       11  norm   ## 170          Port Adelaide       8.0     7.8       5       11  norm   ## 171        North Melbourne       9.0     8.1       5       11  norm   ## 172               Adelaide      10.0    10.5       9       12  norm   ## 173               Essendon      11.0    10.9       9       12  norm   ## 174                 Sydney      11.0    11.3       9       14  norm   ## 175              Fremantle      13.0    13.4      13       14  norm   ## 176         Brisbane Lions      13.5    13.4      12       15  norm   ## 177       Western Bulldogs      15.0    15.4      15       16  norm   ## 178               St Kilda      16.0    15.5      14       17  norm   ## 179             Gold Coast      17.0    17.2      16       18  norm   ## 180                Carlton      18.0    17.7      17       18  norm   ## 181               Richmond       1.0     1.6       1        4  pois   ## 182              Melbourne       2.0     1.9       1        3  pois   ## 183            Collingwood       3.0     3.5       1        5  pois   ## 184                Geelong       4.0     4.7       2        8  pois   ## 185               Hawthorn       5.5     5.2       3        8  pois   ## 186             West Coast       5.5     5.5       2        8  pois   ## 187 Greater Western Sydney       7.0     7.4       5       11  pois   ## 188          Port Adelaide       8.0     7.8       5       11  pois   ## 189        North Melbourne       9.0     8.1       5       11  pois   ## 190               Adelaide      10.0    10.5       9       12  pois   ## 191               Essendon      11.0    10.9       9       12  pois   ## 192                 Sydney      11.0    11.3       9       14  pois   ## 193              Fremantle      13.0    13.4      13       14  pois   ## 194         Brisbane Lions      13.5    13.4      12       15  pois   ## 195       Western Bulldogs      15.0    15.4      15       16  pois   ## 196               St Kilda      16.0    15.5      14       17  pois   ## 197             Gold Coast      17.0    17.2      16       18  pois   ## 198                Carlton      18.0    17.7      17       18  pois   ## 199               Richmond       3.0     2.7       1        5  tanh   ## 200            Collingwood       3.5     3.4       1        7  tanh   ## 201             West Coast       3.5     4.1       1       10  tanh   ## 202               Hawthorn       4.5     4.6       1       10  tanh   ## 203 Greater Western Sydney       5.5     6.4       2       10  tanh   ## 204              Melbourne       6.5     6.0       1       11  tanh   ## 205        North Melbourne       7.0     6.6       2       10  tanh   ## 206       Western Bulldogs       8.0     8.7       5       13  tanh   ## 207                 Sydney       9.5     9.3       3       14  tanh   ## 208               Adelaide      11.0    10.9       2       18  tanh   ## 209              Fremantle      12.0    11.6       8       16  tanh   ## 210          Port Adelaide      12.0    12.0       6       17  tanh   ## 211               Essendon      12.5    11.8       3       18  tanh   ## 212         Brisbane Lions      14.0    14.4      11       18  tanh   ## 213                Geelong      14.5    12.5       4       17  tanh   ## 214               St Kilda      15.0    14.5      10       18  tanh   ## 215             Gold Coast      16.0    15.8      11       18  tanh   ## 216                Carlton      17.0    15.7       6       18  tanh   ## 217               Richmond       1.0     1.6       1        4  norm   ## 218              Melbourne       2.0     1.9       1        3  norm   ## 219            Collingwood       3.0     3.5       1        5  norm   ## 220                Geelong       4.0     4.7       2        8  norm   ## 221               Hawthorn       5.5     5.2       3        8  norm   ## 222             West Coast       5.5     5.5       2        8  norm   ## 223 Greater Western Sydney       7.0     7.4       5       11  norm   ## 224          Port Adelaide       8.0     7.8       5       11  norm   ## 225        North Melbourne       9.0     8.1       5       11  norm   ## 226               Adelaide      10.0    10.5       9       12  norm   ## 227               Essendon      11.0    10.9       9       12  norm   ## 228                 Sydney      11.0    11.3       9       14  norm   ## 229              Fremantle      13.0    13.4      13       14  norm   ## 230         Brisbane Lions      13.5    13.4      12       15  norm   ## 231       Western Bulldogs      15.0    15.4      15       16  norm   ## 232               St Kilda      16.0    15.5      14       17  norm   ## 233             Gold Coast      17.0    17.2      16       18  norm   ## 234                Carlton      18.0    17.7      17       18  norm   ## 235               Richmond       1.0     1.6       1        4  pois   ## 236              Melbourne       2.0     1.9       1        3  pois   ## 237            Collingwood       3.0     3.5       1        5  pois   ## 238                Geelong       4.0     4.7       2        8  pois   ## 239               Hawthorn       5.5     5.2       3        8  pois   ## 240             West Coast       5.5     5.5       2        8  pois   ## 241 Greater Western Sydney       7.0     7.4       5       11  pois   ## 242          Port Adelaide       8.0     7.8       5       11  pois   ## 243        North Melbourne       9.0     8.1       5       11  pois   ## 244               Adelaide      10.0    10.5       9       12  pois   ## 245               Essendon      11.0    10.9       9       12  pois   ## 246                 Sydney      11.0    11.3       9       14  pois   ## 247              Fremantle      13.0    13.4      13       14  pois   ## 248         Brisbane Lions      13.5    13.4      12       15  pois   ## 249       Western Bulldogs      15.0    15.4      15       16  pois   ## 250               St Kilda      16.0    15.5      14       17  pois   ## 251             Gold Coast      17.0    17.2      16       18  pois   ## 252                Carlton      18.0    17.7      17       18  pois   ## 253               Richmond       3.0     2.7       1        5  tanh   ## 254            Collingwood       3.5     3.4       1        7  tanh   ## 255             West Coast       3.5     4.1       1       10  tanh   ## 256               Hawthorn       4.5     4.6       1       10  tanh   ## 257 Greater Western Sydney       5.5     6.4       2       10  tanh   ## 258              Melbourne       6.5     6.0       1       11  tanh   ## 259        North Melbourne       7.0     6.6       2       10  tanh   ## 260       Western Bulldogs       8.0     8.7       5       13  tanh   ## 261                 Sydney       9.5     9.3       3       14  tanh   ## 262               Adelaide      11.0    10.9       2       18  tanh   ## 263              Fremantle      12.0    11.6       8       16  tanh   ## 264          Port Adelaide      12.0    12.0       6       17  tanh   ## 265               Essendon      12.5    11.8       3       18  tanh   ## 266         Brisbane Lions      14.0    14.4      11       18  tanh   ## 267                Geelong      14.5    12.5       4       17  tanh   ## 268               St Kilda      15.0    14.5      10       18  tanh   ## 269             Gold Coast      16.0    15.8      11       18  tanh   ## 270                Carlton      17.0    15.7       6       18  tanh   ##               Type Percent   ## 1       percentWon      60   ## 2       percentWon      30   ## 3       percentWon      10   ## 4       percentWon       0   ## 5       percentWon       0   ## 6       percentWon       0   ## 7       percentWon       0   ## 8       percentWon       0   ## 9       percentWon       0   ## 10      percentWon       0   ## 11      percentWon       0   ## 12      percentWon       0   ## 13      percentWon       0   ## 14      percentWon       0   ## 15      percentWon       0   ## 16      percentWon       0   ## 17      percentWon       0   ## 18      percentWon       0   ## 19      percentWon      60   ## 20      percentWon      30   ## 21      percentWon      10   ## 22      percentWon       0   ## 23      percentWon       0   ## 24      percentWon       0   ## 25      percentWon       0   ## 26      percentWon       0   ## 27      percentWon       0   ## 28      percentWon       0   ## 29      percentWon       0   ## 30      percentWon       0   ## 31      percentWon       0   ## 32      percentWon       0   ## 33      percentWon       0   ## 34      percentWon       0   ## 35      percentWon       0   ## 36      percentWon       0   ## 37      percentWon      30   ## 38      percentWon      10   ## 39      percentWon      20   ## 40      percentWon      30   ## 41      percentWon       0   ## 42      percentWon      10   ## 43      percentWon       0   ## 44      percentWon       0   ## 45      percentWon       0   ## 46      percentWon       0   ## 47      percentWon       0   ## 48      percentWon       0   ## 49      percentWon       0   ## 50      percentWon       0   ## 51      percentWon       0   ## 52      percentWon       0   ## 53      percentWon       0   ## 54      percentWon       0   ## 55     percentTop4     100   ## 56     percentTop4     100   ## 57     percentTop4      70   ## 58     percentTop4      60   ## 59     percentTop4      40   ## 60     percentTop4      30   ## 61     percentTop4       0   ## 62     percentTop4       0   ## 63     percentTop4       0   ## 64     percentTop4       0   ## 65     percentTop4       0   ## 66     percentTop4       0   ## 67     percentTop4       0   ## 68     percentTop4       0   ## 69     percentTop4       0   ## 70     percentTop4       0   ## 71     percentTop4       0   ## 72     percentTop4       0   ## 73     percentTop4     100   ## 74     percentTop4     100   ## 75     percentTop4      70   ## 76     percentTop4      60   ## 77     percentTop4      40   ## 78     percentTop4      30   ## 79     percentTop4       0   ## 80     percentTop4       0   ## 81     percentTop4       0   ## 82     percentTop4       0   ## 83     percentTop4       0   ## 84     percentTop4       0   ## 85     percentTop4       0   ## 86     percentTop4       0   ## 87     percentTop4       0   ## 88     percentTop4       0   ## 89     percentTop4       0   ## 90     percentTop4       0   ## 91     percentTop4      90   ## 92     percentTop4      80   ## 93     percentTop4      60   ## 94     percentTop4      50   ## 95     percentTop4      30   ## 96     percentTop4      30   ## 97     percentTop4      10   ## 98     percentTop4       0   ## 99     percentTop4      10   ## 100    percentTop4      10   ## 101    percentTop4       0   ## 102    percentTop4       0   ## 103    percentTop4      20   ## 104    percentTop4       0   ## 105    percentTop4      10   ## 106    percentTop4       0   ## 107    percentTop4       0   ## 108    percentTop4       0   ## 109    percentTop8     100   ## 110    percentTop8     100   ## 111    percentTop8     100   ## 112    percentTop8     100   ## 113    percentTop8     100   ## 114    percentTop8     100   ## 115    percentTop8      80   ## 116    percentTop8      80   ## 117    percentTop8      40   ## 118    percentTop8       0   ## 119    percentTop8       0   ## 120    percentTop8       0   ## 121    percentTop8       0   ## 122    percentTop8       0   ## 123    percentTop8       0   ## 124    percentTop8       0   ## 125    percentTop8       0   ## 126    percentTop8       0   ## 127    percentTop8     100   ## 128    percentTop8     100   ## 129    percentTop8     100   ## 130    percentTop8     100   ## 131    percentTop8     100   ## 132    percentTop8     100   ## 133    percentTop8      80   ## 134    percentTop8      80   ## 135    percentTop8      40   ## 136    percentTop8       0   ## 137    percentTop8       0   ## 138    percentTop8       0   ## 139    percentTop8       0   ## 140    percentTop8       0   ## 141    percentTop8       0   ## 142    percentTop8       0   ## 143    percentTop8       0   ## 144    percentTop8       0   ## 145    percentTop8     100   ## 146    percentTop8     100   ## 147    percentTop8      90   ## 148    percentTop8      90   ## 149    percentTop8      60   ## 150    percentTop8      90   ## 151    percentTop8      90   ## 152    percentTop8      50   ## 153    percentTop8      40   ## 154    percentTop8      20   ## 155    percentTop8      10   ## 156    percentTop8      10   ## 157    percentTop8      20   ## 158    percentTop8       0   ## 159    percentTop8      20   ## 160    percentTop8       0   ## 161    percentTop8       0   ## 162    percentTop8      10   ## 163 percentBottom4       0   ## 164 percentBottom4       0   ## 165 percentBottom4       0   ## 166 percentBottom4       0   ## 167 percentBottom4       0   ## 168 percentBottom4       0   ## 169 percentBottom4       0   ## 170 percentBottom4       0   ## 171 percentBottom4       0   ## 172 percentBottom4       0   ## 173 percentBottom4       0   ## 174 percentBottom4       0   ## 175 percentBottom4       0   ## 176 percentBottom4      20   ## 177 percentBottom4     100   ## 178 percentBottom4      80   ## 179 percentBottom4     100   ## 180 percentBottom4     100   ## 181 percentBottom4       0   ## 182 percentBottom4       0   ## 183 percentBottom4       0   ## 184 percentBottom4       0   ## 185 percentBottom4       0   ## 186 percentBottom4       0   ## 187 percentBottom4       0   ## 188 percentBottom4       0   ## 189 percentBottom4       0   ## 190 percentBottom4       0   ## 191 percentBottom4       0   ## 192 percentBottom4       0   ## 193 percentBottom4       0   ## 194 percentBottom4      20   ## 195 percentBottom4     100   ## 196 percentBottom4      80   ## 197 percentBottom4     100   ## 198 percentBottom4     100   ## 199 percentBottom4       0   ## 200 percentBottom4       0   ## 201 percentBottom4       0   ## 202 percentBottom4       0   ## 203 percentBottom4       0   ## 204 percentBottom4       0   ## 205 percentBottom4       0   ## 206 percentBottom4       0   ## 207 percentBottom4       0   ## 208 percentBottom4      20   ## 209 percentBottom4      10   ## 210 percentBottom4      10   ## 211 percentBottom4      30   ## 212 percentBottom4      40   ## 213 percentBottom4      50   ## 214 percentBottom4      60   ## 215 percentBottom4      90   ## 216 percentBottom4      90   ## 217    percentLast       0   ## 218    percentLast       0   ## 219    percentLast       0   ## 220    percentLast       0   ## 221    percentLast       0   ## 222    percentLast       0   ## 223    percentLast       0   ## 224    percentLast       0   ## 225    percentLast       0   ## 226    percentLast       0   ## 227    percentLast       0   ## 228    percentLast       0   ## 229    percentLast       0   ## 230    percentLast       0   ## 231    percentLast       0   ## 232    percentLast       0   ## 233    percentLast      30   ## 234    percentLast      70   ## 235    percentLast       0   ## 236    percentLast       0   ## 237    percentLast       0   ## 238    percentLast       0   ## 239    percentLast       0   ## 240    percentLast       0   ## 241    percentLast       0   ## 242    percentLast       0   ## 243    percentLast       0   ## 244    percentLast       0   ## 245    percentLast       0   ## 246    percentLast       0   ## 247    percentLast       0   ## 248    percentLast       0   ## 249    percentLast       0   ## 250    percentLast       0   ## 251    percentLast      30   ## 252    percentLast      70   ## 253    percentLast       0   ## 254    percentLast       0   ## 255    percentLast       0   ## 256    percentLast       0   ## 257    percentLast       0   ## 258    percentLast       0   ## 259    percentLast       0   ## 260    percentLast       0   ## 261    percentLast       0   ## 262    percentLast      10   ## 263    percentLast       0   ## 264    percentLast       0   ## 265    percentLast      10   ## 266    percentLast      10   ## 267    percentLast       0   ## 268    percentLast      10   ## 269    percentLast      30   ## 270    percentLast      30</code></p>
<p>```r #create ordered factor to order graph comparisonSimTable.2018.tidy<span class="math inline">\(Team &lt;- factor(comparisonSimTable.2018.tidy\)</span>Team, levels = Finalsimtablepois.2018$Team)</p>
<p>#create ordered factor of ‘Type’ to order facet comparisonSimTable.2018.tidy<span class="math inline">\(Type &lt;- factor(comparisonSimTable.2018.tidy\)</span>Type, levels = c(“percentWon”, “percentTop4”, “percentTop8”, “percentBottom4”, “percentLast”))</p>
<p>#draw graphs ggplot(comparisonSimTable.2018, aes(x = Team, y = percentWon, fill = Model)) + geom_bar(stat = “identity”, position = ‘dodge’) ```</p>
<p><img src="/blog/2019-03-30-simulation-stimulation-afl-season-2018_files/figure-html/graphs-3.png" width="672" /></p>
<p><code>r   ggplot(comparisonSimTable.2018, aes(x = Team, y = percentTop8, fill = Model)) +     geom_bar(stat = &quot;identity&quot;, position = 'dodge')</code></p>
<p><img src="/blog/2019-03-30-simulation-stimulation-afl-season-2018_files/figure-html/graphs-4.png" width="672" /></p>
<p><code>r   ggplot(comparisonSimTable.2018.tidy, aes(x = Team, y = Percent, fill = Model)) +      geom_bar(stat = &quot;identity&quot;, position = 'dodge') +      theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6)) +     facet_wrap(~Type, nrow = 1)</code></p>
<p><img src="/blog/2019-03-30-simulation-stimulation-afl-season-2018_files/figure-html/graphs-5.png" width="672" /></p>
<p><code>r   ## WHich of these two models best captures last years fnal table.   # Personally, I think the normal distribution model is by far the best of these two, It alligns with the variable nature of afl football and gives more beleiveable results.   # It also allows for teams which footy intution says have a chance of winning the cup to win the cup. # but lets see which dataset best comports with last years data.    # lets import last years finaltable data.     #also note that comparing with last year isnt the  best method, because we have a different fixture (unlike football in the UK everyteam does not play eachother twice )</code></p>
